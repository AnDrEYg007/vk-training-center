import React from 'react';
import { Sandbox, NavigationButtons } from '../shared';
import { 
    ListCardAnatomy, 
    AllCardStates, 
    CardWithDropdown, 
    InteractiveCardDemo 
} from './ListsMocks';

export const ListCardAnatomyPage: React.FC = () => {
    return (
        <div className="prose max-w-none">
            <h1>3.2.2. Карточка списка</h1>

            <p className="text-lg">
                Карточка списка — это компактный блок 160×160 пикселей, который показывает ключевую информацию: 
                название, количество участников, дату обновления и кнопку для синхронизации. Раньше приходилось открывать 
                каждый список отдельно, чтобы понять что внутри. Теперь — вся информация на карточке.
            </p>

            {/* ===================================================================== */}
            {/* АНАТОМИЯ КАРТОЧКИ */}
            {/* ===================================================================== */}
            <section>
                <h2>Из чего состоит карточка</h2>

                <p>
                    Карточка делится на 3 зоны: <strong>Header</strong> (шапка), <strong>Body</strong> (тело) 
                    и <strong>Footer</strong> (подвал). Каждая зона отвечает за свою информацию.
                </p>

                <Sandbox
                    title="Структура карточки списка"
                    description="Разметка показывает где какой элемент расположен"
                    height="240px"
                >
                    <div className="flex justify-center">
                        <ListCardAnatomy />
                    </div>
                </Sandbox>

                <h3>Header (шапка)</h3>

                <ul>
                    <li><strong>Иконка списка</strong> — квадрат 40×40 пикселей с цветным фоном и белой SVG-иконкой. 
                    Цвет фона зависит от типа списка: синий для подписчиков, розовый для лайков, фиолетовый для репостов и т.д.</li>
                    <li><strong>Кнопка обновления</strong> — круглая кнопка справа с иконкой циркулярной стрелки. 
                    При наведении становится синей с фоном. При обновлении превращается в крутящийся спиннер.</li>
                </ul>

                <h3>Body (тело)</h3>

                <ul>
                    <li><strong>Счётчик</strong> — крупное число с разделителями разрядов (1,234 вместо 1234). 
                    Для списка постов показывается два числа: сколько загружено в систему из общего количества в ВК.</li>
                    <li><strong>Название списка</strong> — текст до 2 строк, остальное обрезается многоточием. 
                    Размер шрифта 14px, серый цвет.</li>
                    <li><strong>Блок статуса</strong> — зарезервированное пространство 20px высотой. Показывает 
                    «Загрузка подписчиков...» или «Анализ рассылки...» во время синхронизации. Пустое, если обновления нет.</li>
                </ul>

                <h3>Footer (подвал)</h3>

                <ul>
                    <li><strong>Дата обновления</strong> — маленький текст с иконкой часов. Формат: «23 дек, 14:30». 
                    Если список ещё не обновлялся — показывается «Нет данных».</li>
                </ul>
            </section>

            {/* ===================================================================== */}
            {/* СОСТОЯНИЯ КАРТОЧКИ */}
            {/* ===================================================================== */}
            <section>
                <h2>Состояния карточки</h2>

                <p>
                    Карточка меняет внешний вид в зависимости от действий пользователя и процессов в системе. 
                    Всего 5 состояний.
                </p>

                <Sandbox
                    title="Все состояния карточки"
                    description="Посмотрите как меняется внешний вид карточки в разных ситуациях"
                    height="280px"
                >
                    <AllCardStates />
                </Sandbox>

                <h3>1. Обычное состояние</h3>

                <p>
                    Карточка в покое. Серая рамка (border-gray-200), лёгкая тень. Кнопка обновления серая. 
                    Это состояние по умолчанию — список просто отображается, ничего не происходит.
                </p>

                <h3>2. При наведении курсора</h3>

                <p>
                    Рамка становится темнее (border-gray-300), тень усиливается (shadow-md). Кнопка обновления становится 
                    синей с голубым фоном. Переход плавный — 200 миллисекунд. Это подсказка: карточка кликабельна.
                </p>

                <h3>3. Активная (выбранная)</h3>

                <p>
                    Когда вы открыли список для просмотра, карточка выделяется. Серая рамка исчезает, вместо неё появляется 
                    яркая синяя обводка в 2 пикселя (ring-2 ring-indigo-500). Тень остаётся усиленной. Это показывает: 
                    вы сейчас работаете с этим списком.
                </p>

                <h3>4. Обновляется (синхронизация)</h3>

                <p>
                    Кнопка обновления превращается в крутящийся спиннер. В блоке статуса появляется текст «Загрузка подписчиков...» 
                    или «Анализ рассылки...» с маленьким спиннером и пульсацией. Это показывает: система сейчас собирает данные из ВКонтакте.
                </p>

                <p><strong>Визуальные эффекты при загрузке:</strong></p>

                <ul>
                    <li>Спиннер в кнопке — вращается с постоянной скоростью (0.6 секунды оборот)</li>
                    <li>Спиннер в блоке статуса — меньше размером, вращается с той же скоростью</li>
                    <li>Весь блок статуса пульсирует (animate-pulse) — привлекает внимание</li>
                    <li>Текст статуса синий (text-indigo-600) — цвет процесса</li>
                </ul>

                <h3>5. Пустая (0 участников)</h3>

                <p>
                    Счётчик показывает 0, дата обновления — «Нет данных». Визуально карточка выглядит так же, как обычная, 
                    но информирует: список существует, но пустой. Это нормально для новых списков или после массового выхода участников.
                </p>
            </section>

            {/* ===================================================================== */}
            {/* ИНТЕРАКТИВНАЯ ДЕМОНСТРАЦИЯ */}
            {/* ===================================================================== */}
            <section>
                <h2>Попробуйте сами</h2>

                <p>
                    Кликайте на кнопки справа, чтобы переключать состояния карточки. Обратите внимание на детали: 
                    как меняется рамка, тень, цвет кнопки, появляется спиннер.
                </p>

                <Sandbox
                    title="Интерактивная карточка"
                    description="Переключайте состояния и наблюдайте за изменениями"
                    height="220px"
                >
                    <InteractiveCardDemo />
                </Sandbox>
            </section>

            {/* ===================================================================== */}
            {/* КНОПКА ОБНОВЛЕНИЯ */}
            {/* ===================================================================== */}
            <section>
                <h2>Кнопка обновления</h2>

                <p>
                    Не у всех списков есть кнопка обновления. Например, списки конкурсов управляются вручную — 
                    их не нужно синхронизировать с ВКонтакте.
                </p>

                <h3>Когда кнопка появляется</h3>

                <ul>
                    <li><strong>Подписчики, история вступлений/выходов</strong> — кнопка есть, запускает синхронизацию через groups.getMembers</li>
                    <li><strong>В рассылке</strong> — кнопка есть, обновляет список через messages.getConversations</li>
                    <li><strong>Активности (лайки, комментарии, репосты)</strong> — кнопка есть, перебирает посты и собирает участников</li>
                    <li><strong>Посты (История)</strong> — кнопка есть, но особенная (об этом ниже)</li>
                    <li><strong>Конкурс отзывов</strong> — кнопки нет, управление вручную через интерфейс конкурса</li>
                </ul>

                <h3>Обычная кнопка vs Dropdown меню</h3>

                <p>
                    Для большинства списков кнопка работает просто: клик → запуск синхронизации. Но для списка постов 
                    есть <strong>два режима обновления</strong>, поэтому кнопка открывает выпадающее меню с выбором:
                </p>

                <ul>
                    <li><strong>Обновить 1000 (быстро)</strong> — загрузить первую тысячу постов со стены. Занимает пару минут.</li>
                    <li><strong>Обновить всё (долго)</strong> — загрузить все посты с начала времён. Может занять 10-20 минут для больших сообществ.</li>
                </ul>

                <Sandbox
                    title="Карточка с dropdown меню"
                    description="Кликните на кнопку обновления и выберите режим синхронизации"
                    height="240px"
                >
                    <div className="flex justify-center">
                        <CardWithDropdown />
                    </div>
                </Sandbox>

                <div className="bg-indigo-50 border border-indigo-200 rounded-lg p-4 my-6">
                    <div className="flex items-start gap-3">
                        <svg className="w-5 h-5 text-indigo-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clipRule="evenodd" />
                        </svg>
                        <div>
                            <h4 className="text-sm font-bold text-indigo-900 mb-1">Почему два режима?</h4>
                            <p className="text-sm text-indigo-800 mb-0">
                                Режим «1000 (быстро)» используется для регулярного обновления метрик свежих постов. 
                                Режим «всё (долго)» нужен один раз при первом запуске или когда хотите собрать всю историю 
                                для глубокой аналитики.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            {/* ===================================================================== */}
            {/* СЧЁТЧИК УЧАСТНИКОВ */}
            {/* ===================================================================== */}
            <section>
                <h2>Счётчик участников</h2>

                <p>
                    Крупное число в центре карточки — это счётчик. Он показывает сколько людей в списке. 
                    Система автоматически добавляет разделители разрядов для читаемости: 1234 становится 1,234.
                </p>

                <h3>Обычный режим счётчика</h3>

                <p>
                    Для большинства списков — просто число. Примеры:
                </p>

                <ul>
                    <li>Подписчики: <strong>3,456</strong> — в сообществе 3456 человек</li>
                    <li>Лайкали: <strong>892</strong> — 892 человека лайкнули хотя бы один пост</li>
                    <li>В рассылке: <strong>1,205</strong> — 1205 человек разрешили писать в диалог</li>
                </ul>

                <h3>Двойной счётчик для постов</h3>

                <p>
                    Список «Посты (История)» показывает два числа:
                </p>

                <div className="not-prose bg-white border-2 border-gray-300 rounded-lg p-4 my-6">
                    <div className="text-2xl font-bold text-gray-900 mb-1">856</div>
                    <p className="text-[10px] text-gray-500 mb-0">из 3,240 в VK</p>
                </div>

                <p>
                    <strong>856</strong> — столько постов загружено в систему (в базе данных). 
                    <strong>3,240</strong> — общее количество постов на стене сообщества в ВКонтакте.
                </p>

                <p><strong>Зачем это нужно:</strong></p>

                <p>
                    Вы сразу видите: загружена вся история или только часть. Если цифры не совпадают — 
                    можно запустить полную синхронизацию через режим «всё (долго)».
                </p>
            </section>

            {/* ===================================================================== */}
            {/* ДАТА ОБНОВЛЕНИЯ */}
            {/* ===================================================================== */}
            <section>
                <h2>Дата последнего обновления</h2>

                <p>
                    В футере карточки — маленький текст с иконкой часов. Показывает когда список синхронизировался последний раз.
                </p>

                <h3>Формат даты</h3>

                <p>
                    Дата отображается в сокращённом формате: <strong>23 дек, 14:30</strong>. 
                    Это удобнее чем «23.12.2025 14:30:00» — меньше места, быстрее читается.
                </p>

                <h3>Когда даты нет</h3>

                <p>
                    Если список только создан и ещё не обновлялся, вместо даты показывается <strong>«Нет данных»</strong>. 
                    Это нормально — просто запустите первую синхронизацию через кнопку обновления.
                </p>

                <h3>Зачем нужна дата</h3>

                <p>
                    Представьте: вы видите список лайков с датой «15 янв, 10:00», а сейчас 25 января. Значит, данные устарели — 
                    за 10 дней могли появиться новые лайки. Пора обновить. Дата помогает понять: актуальны ли данные или пора синхронизироваться.
                </p>
            </section>

            {/* ===================================================================== */}
            {/* ВИЗУАЛЬНЫЕ ДЕТАЛИ */}
            {/* ===================================================================== */}
            <section>
                <h2>Визуальные детали</h2>

                <p>
                    Карточка спроектирована так, чтобы было понятно что кликабельно, а что просто информация.
                </p>

                <h3>Цвета иконок по типам</h3>

                <div className="not-prose grid grid-cols-2 gap-4 my-6">
                    <div className="bg-white border border-gray-200 rounded-lg p-4">
                        <h4 className="text-sm font-bold text-gray-700 mb-3">Подписчики</h4>
                        <div className="flex flex-wrap gap-2">
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-indigo-500 rounded"></div>
                                <span className="text-xs">Подписчики</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-cyan-600 rounded"></div>
                                <span className="text-xs">В рассылке</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-teal-500 rounded"></div>
                                <span className="text-xs">Вступившие</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-orange-500 rounded"></div>
                                <span className="text-xs">Вышедшие</span>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white border border-gray-200 rounded-lg p-4">
                        <h4 className="text-sm font-bold text-gray-700 mb-3">Активности</h4>
                        <div className="flex flex-wrap gap-2">
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-pink-500 rounded"></div>
                                <span className="text-xs">Лайкали</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-blue-500 rounded"></div>
                                <span className="text-xs">Комментировали</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-purple-500 rounded"></div>
                                <span className="text-xs">Репостили</span>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white border border-gray-200 rounded-lg p-4">
                        <h4 className="text-sm font-bold text-gray-700 mb-3">Автоматизации</h4>
                        <div className="flex flex-wrap gap-2">
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-amber-500 rounded"></div>
                                <span className="text-xs">Победители</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-green-500 rounded"></div>
                                <span className="text-xs">Участники</span>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white border border-gray-200 rounded-lg p-4">
                        <h4 className="text-sm font-bold text-gray-700 mb-3">Прочее</h4>
                        <div className="flex flex-wrap gap-2">
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-indigo-800 rounded"></div>
                                <span className="text-xs">Посты</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 bg-violet-600 rounded"></div>
                                <span className="text-xs">Авторы</span>
                            </div>
                        </div>
                    </div>
                </div>

                <h3>Анимации и переходы</h3>

                <ul>
                    <li><strong>Переход состояний</strong> — 200 миллисекунд (transition-all duration-200). Достаточно быстро, чтобы не раздражать, достаточно медленно, чтобы заметить изменение.</li>
                    <li><strong>Спиннер</strong> — один полный оборот за 600 миллисекунд. Скорость постоянная (linear), без ускорений.</li>
                    <li><strong>Пульсация</strong> — блок статуса плавно меняет прозрачность (animate-pulse). Привлекает внимание к процессу загрузки.</li>
                </ul>

                <h3>Тени и обводки</h3>

                <ul>
                    <li><strong>shadow-sm</strong> — лёгкая тень в обычном состоянии. Карточка слегка приподнята над фоном.</li>
                    <li><strong>shadow-md</strong> — средняя тень при наведении и в активном состоянии. Карточка «всплывает» выше.</li>
                    <li><strong>ring-2 ring-indigo-500</strong> — яркая синяя обводка для активной карточки. Толщина 2 пикселя, чётко видна.</li>
                </ul>
            </section>

            {/* ===================================================================== */}
            {/* ИТОГИ */}
            {/* ===================================================================== */}
            <section>
                <h2>Итого</h2>

                <div className="not-prose bg-gradient-to-r from-indigo-50 to-purple-50 border-2 border-indigo-200 rounded-lg p-6 my-6">
                    <h3 className="text-lg font-bold text-gray-900 mb-4">Что важно запомнить:</h3>
                    <ul className="space-y-2 text-sm text-gray-700">
                        <li className="flex items-start gap-2">
                            <span className="text-indigo-600 font-bold">✓</span>
                            <span><strong>3 зоны</strong> — Header (иконка + кнопка), Body (счётчик + название + статус), Footer (дата)</span>
                        </li>
                        <li className="flex items-start gap-2">
                            <span className="text-indigo-600 font-bold">✓</span>
                            <span><strong>5 состояний</strong> — обычное, при наведении, активное, обновляется, пустое</span>
                        </li>
                        <li className="flex items-start gap-2">
                            <span className="text-indigo-600 font-bold">✓</span>
                            <span><strong>Кнопка обновления</strong> — не у всех списков есть, для постов — dropdown меню</span>
                        </li>
                        <li className="flex items-start gap-2">
                            <span className="text-indigo-600 font-bold">✓</span>
                            <span><strong>Двойной счётчик</strong> — только для постов (загружено / всего в VK)</span>
                        </li>
                        <li className="flex items-start gap-2">
                            <span className="text-indigo-600 font-bold">✓</span>
                            <span><strong>Цвет иконки</strong> — зависит от типа списка (синий = подписчики, розовый = лайки и т.д.)</span>
                        </li>
                        <li className="flex items-start gap-2">
                            <span className="text-indigo-600 font-bold">✓</span>
                            <span><strong>Дата обновления</strong> — помогает понять актуальность данных</span>
                        </li>
                    </ul>
                </div>
            </section>

            {/* ===================================================================== */}
            {/* НАВИГАЦИЯ */}
            {/* ===================================================================== */}
            <NavigationButtons prevPath="3-2-1-types" nextPath="3-3-statistics" />
        </div>
    );
};
