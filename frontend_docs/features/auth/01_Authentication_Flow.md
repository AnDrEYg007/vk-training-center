# Процесс Аутентификации

**Контекст:** `features/auth/contexts/AuthContext.tsx`
**Компонент:** `features/auth/components/LoginPage.tsx`

## 1. Архитектура безопасности

Приложение использует простую, но эффективную систему сессий на базе `sessionStorage`.
*   **Состояние:** `AuthContext` хранит объект `user` (`{ username, role }`).
*   **Инициализация:** При загрузке приложения `AuthProvider` проверяет наличие данных в `sessionStorage`.
*   **Защита маршрутов:** В `App.tsx`, если `user === null` и загрузка завершена, рендерится только `LoginPage`.

## 2. Страница входа (`LoginPage`)

Помимо формы ввода логина/пароля, этот компонент выполняет важную инфраструктурную функцию.

### Переключение окружения API
Внизу формы входа расположен переключатель "Окружение API" (Продакшен / Предпродакшен / Локальный).
*   **Логика:** Выбор сохраняется в `localStorage` (ключ `api_environment`).
*   **Применение:** Файл `shared/config.ts` читает этот ключ при старте и определяет `API_BASE_URL`.
*   **UX:** При смене окружения страница автоматически перезагружается, чтобы применить настройки глобально.

## 3. Взаимодействие с API
*   При входе отправляется запрос `/api/auth/login`.
*   Бэкенд проверяет credentials.
    *   Сначала сверяет с переменными окружения `ADMIN_USERNAME`/`PASSWORD` (для супер-админа).
    *   Затем ищет в таблице `users` в БД.
*   Пароли в текущей версии хранятся в открытом виде (для простоты MVP), но архитектура готова к внедрению хеширования.