# API Контракт: VK Content Planner (Python/FastAPI Backend)

Этот документ описывает принципы взаимодействия с бэкендом на Python/FastAPI.

## 1. Источник правды: Swagger UI

В отличие от предыдущей версии на Google Apps Script, API контракт больше **не ведется вручную**. Бэкенд на FastAPI автоматически генерирует интерактивную документацию на основе кода, используя стандарт OpenAPI.

**Swagger UI — это единственный актуальный источник информации об API.**

### Как получить доступ к документации:

1.  Запустите бэкенд-сервер на Python (инструкции в `backend_python/README.md.txt`).
2.  Откройте в браузере следующий адрес:
    -   **URL**: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)

### Что вы найдете в Swagger UI:

-   **Полный список эндпоинтов**: Все доступные пути (например, `/api/getInitialData`, `/api/tags/getForProject`, `/api/auth/login`).
-   **Структура запросов**: Точные модели данных (схемы Pydantic), которые нужно отправлять в теле `POST` запроса. Эти модели определены в пакете `backend_python/schemas/` и разделены на файлы `base_models.py`, `api_payloads.py` и `api_responses.py`.
-   **Структура ответов**: Точные модели данных, которые сервер возвращает при успешном выполнении.
-   **Интерактивное тестирование**: Возможность отправлять тестовые запросы и видеть реальные ответы прямо из браузера, что кардинально ускоряет разработку и отладку.

## 2. Общие принципы взаимодействия

-   **Эндпоинт**: Каждый `action` из старого API теперь является отдельным эндпоинтом.
    -   **Пример**: `action: "getInitialData"` стал `POST /api/getInitialData`.
-   **Формат**: Все запросы — это `POST` запросы с `Content-Type: application/json`. Тело запроса соответствует схеме, описанной в Swagger.
-   **Ответы**: 
    -   Успешные ответы возвращают JSON с данными (статус `200 OK`).
    -   Ошибки валидации возвращаются со статусом `422 Unprocessable Entity` и подробным описанием неверных полей.
    -   Прочие ошибки возвращаются со стандартными кодами состояния HTTP (4xx, 5xx) и JSON-телом вида `{"detail": "Сообщение об ошибке"}`.

## 3. Ключевые изменения в данных

С внедрением системы тегирования и аутентификации, структура данных была обновлена:
-   **Посты (`ScheduledPost`)**: Теперь содержат поле `tags`, которое является массивом объектов-тегов (`[{ "id": "...", "name": "...", ... }]`).
-   **Новые эндпоинты**: Добавлены группы эндпоинтов для управления тегами (`/api/tags/`), аутентификацией (`/api/auth/`), пользователями (`/api/users/`), шаблонами AI-инструкций (`/api/ai-presets/`) и **глобальными переменными (`/api/global-variables/`)**.