# Управление Заметками (Notes)

**Ключевой файл:** `backend_python/services/note_service.py`
**Роутер:** `backend_python/routers/notes.py`

Этот модуль содержит всю бизнес-логику для CRUD-операций с Заметками (стикерами) в календаре.

---

## 1. Концепция Заметок

Заметки — это внутренние "напоминалки" или комментарии, которые пользователи могут прикреплять к определенной дате и времени в календаре проекта. Они не предназначены для публикации в VK и служат исключительно для внутренней организации работы команды.

-   **Сущность:** Заметка (`Note`) имеет `title` (опционально), `text`, `color` и `date`.
-   **Цветовое кодирование:** Пользователь может выбрать один из 7 предустановленных пастельных цветов для визуальной категоризации заметок.

---

## 2. API и Поток данных

### `POST /api/getNotes`
-   **Назначение:** Получить все заметки для одного проекта.
-   **Логика:** Вызывает `crud.get_notes_by_project_id`.

### `POST /api/saveNote`
-   **Назначение:** Создать новую заметку или обновить существующую.
-   **Логика:**
    1.  Сервис `note_service.save_note` передает данные в `crud.save_note`.
    2.  CRUD-функция проверяет `id` заметки. Если он начинается с `new-note-`, создается новая запись с новым `uuid`. В противном случае, находится существующая запись и ее поля обновляются.
    3.  Все изменения сохраняются в одной транзакции.

### `POST /api/deleteNote`
-   **Назначение:** Удалить заметку.
-   **Логика:** Вызывает `crud.delete_note`, который выполняет `DELETE` в базе данных.

---

## 3. Слой доступа к данным (`crud/note_crud.py`)

-   **`get_notes_by_project_id(db, project_id)`**: `SELECT * FROM notes WHERE projectId = ...`
-   **`save_note(db, note_data, project_id)`**: Реализует логику "upsert" (update or insert).
-   **`delete_note(db, note_id)`**: `DELETE FROM notes WHERE id = ...`
