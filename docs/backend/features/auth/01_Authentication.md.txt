# Аутентификация

**Ключевой файл:** `backend_python/services/auth_service.py`

Этот модуль отвечает за проверку учетных данных пользователя.

---

## 1. Основные функции

### `authenticate_user(db, username, password)`
-   **Назначение:** Проверить, существует ли пользователь с указанным логином и паролем, и определить его роль.
-   **Пошаговая логика:**
    1.  **Проверка администратора:**
        -   Сравнивает `username` и `password` с переменными `ADMIN_USERNAME` и `ADMIN_PASSWORD` из файла `.env` (загруженными через `config.py`).
        -   Если есть совпадение, немедленно возвращает `{"success": True, "role": "admin", ...}`.
    2.  **Проверка обычного пользователя:**
        -   Если проверка на администратора не прошла, вызывает `crud.get_user_by_username(db, username)` для поиска пользователя в таблице `users`.
        -   Если пользователь найден, сравнивает хэш пароля из запроса с хэшем в БД.
        -   Если совпадает, возвращает `{"success": True, "role": "user", ...}`.
        -   **Примечание:** В текущей реализации пароли хранятся в открытом виде для простоты. В продакшен-системе здесь должно быть сравнение хэшей.
    3.  **Неудача:** Если ни одно из условий не выполнено, возвращает `None`.
-   **Связи:**
    -   Вызывается из: `routers/auth.py`.
    -   Вызывает: `crud.get_user_by_username`.