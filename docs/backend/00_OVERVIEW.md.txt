# 0. Обзор бэкенда

Этот документ предоставляет высокоуровневый обзор архитектуры, технологий и ключевых задач бэкенд-сервера.

## 1. Назначение и ключевые задачи

Бэкенд на Python/FastAPI является "мозгом" всего приложения. Он выполняет следующие основные функции:

1.  **Предоставление API для фронтенда**: Обрабатывает все запросы от React-приложения.
2.  **Бизнес-логика**: Реализует всю логику работы с постами, проектами, тегами, товарами и т.д.
3.  **Взаимодействие с VK API**: Выполняет все запросы к ВКонтакте для получения и публикации контента.
4.  **Взаимодействие с Gemini API**: Отправляет запросы к AI для генерации и коррекции текста.
5.  **Хранение данных**: Управляет базой данных (SQLite/PostgreSQL), которая служит кешем для данных из VK и хранилищем для настроек, заметок и системных постов.
6.  **Обработка фоновых событий**: Принимает и обрабатывает уведомления (callbacks) от VK, а также выполняет фоновые задачи (Пост-трекер).
7.  **Управление товарами (VK Market)**: Предоставляет API для просмотра, редактирования и AI-ассистирования при работе с товарами сообщества.

## 2. Технологический стек

-   **FastAPI**: Современный, асинхронный и высокопроизводительный веб-фреймворк для создания API. Обеспечивает автоматическую валидацию данных и генерацию документации.
-   **SQLAlchemy**: Мощная ORM (Object-Relational Mapper), которая позволяет работать с базой данных, используя Python-классы вместо написания SQL-запросов вручную.
-   **SQLite / PostgreSQL**: Поддержка двух СУБД для гибкой разработки и развертывания.
-   **Pydantic**: Библиотека для валидации данных, которая лежит в основе FastAPI. Она гарантирует, что данные, приходящие на бэкенд и уходящие с него, соответствуют заранее определенным схемам.
-   **Uvicorn / Gunicorn**: ASGI-серверы, которые запускают FastAPI-приложение.

## 3. Основные принципы архитектуры

-   **Разделение ответственности (Separation of Concerns)**: Код четко разделен на слои. `routers` принимают запросы, `services` содержат бизнес-логику, а `crud` работает с базой данных. Это делает код чистым и легко поддерживаемым.
-   **"Код как документация"**: Вместо ручного ведения API-контракта, структура API определяется Pydantic-схемами (`schemas/`), а FastAPI автоматически генерирует из них интерактивную документацию (Swagger UI).
-   **Надежность**: Взаимодействие с внешними API (особенно VK) обернуто в логику с автоматическими повторными попытками, что делает систему более устойчивой к временным сбоям.
-   **"Нулевая настройка"**: База данных и ее таблицы создаются автоматически при первом запуске, что упрощает развертывание и начало работы.
