# Процессы создания товаров

В системе реализовано два сценария создания: для одного товара (детальный) и для множества (табличный).

## 1. Создание одного товара (`CreateSingleProductModal`)

**Хук:** `features/products/hooks/useCreateSingleProduct.ts`

### Особенности UI
*   **Фото:** Пользователь может загрузить файл с диска ИЛИ вставить прямую ссылку на изображение. Компонент `NewPhotoCell` валидирует ссылку (пытается загрузить картинку) перед сохранением.
*   **Описание:** Использует полноценный редактор (`DescriptionSection`) с поддержкой AI-генератора и переменных проекта.
*   **Настройки проекта:** Если пользователю нужно добавить переменную, он может открыть настройки проекта прямо из модального окна создания товара (поверх него).

### Логика сохранения
1.  Валидация обязательных полей (красная подсветка).
2.  Если выбрано фото-файл: оно загружается на сервер VK (`photos.getMarketUploadServer` -> save).
3.  Вызывается `market.add`.
4.  Если выбрана подборка, вызывается `market.addToAlbum`.
5.  Товар добавляется в локальный стейт (`setItems`), таблица обновляется без перезагрузки.

## 2. Массовое создание (`CreateMultipleProductsModal`)

**Хук:** `features/products/hooks/useCreateMultipleProducts.ts`

### Концепция "Динамической таблицы"
Интерфейс представляет собой таблицу, где каждая строка — это черновик нового товара (`NewProductRow`).
*   Изначально отображается 2 пустые строки.
*   Кнопка "+ Добавить товар" добавляет новую строку.
*   Кнопка "Копировать" (в строке) дублирует текущую строку (цену, категорию, подборку), но очищает название и фото.

### Валидация и Обработка ошибок
*   **Построчная валидация:** Перед отправкой проверяется каждая строка. Если есть ошибки, они подсвечиваются, и отправка блокируется.
*   **Частичный успех:** Отправка происходит последовательно.
    *   Если 5 товаров сохранились, а 2 упали с ошибкой:
        *   Успешные товары удаляются из таблицы и появляются в основном списке.
        *   Неудачные товары остаются в таблице.
        *   Появляется консоль ошибок с детальным описанием причины для каждой строки.

### Технические детали
*   Использует временные ID (`tempId = uuidv4()`) для отслеживания строк React-ом.
*   Фотографии хранятся в памяти (`File` объект) до момента сохранения.