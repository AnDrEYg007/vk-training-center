
# Управление Контекстом Проекта

**Компонент:** `features/database-management/components/ProjectContextManagement.tsx`
**Хук:** `features/database-management/hooks/useProjectContext.ts`

Этот раздел позволяет администраторам управлять структурированными данными о проектах, которые используются нейросетями для генерации более точного и релевантного контента.

## 1. Таблица Контекста (`ContextTable`)

Основной интерфейс представляет собой матрицу "Проекты × Поля".

### Управление структурой
*   **Добавление столбцов:** Кнопка "+ Столбец" позволяет создать новое поле контекста. Можно указать, является ли поле глобальным (для всех проектов) или доступным только для выбранных.
*   **Типы полей:** Все поля хранят текстовые данные (String/Text).
*   **Редактирование значений:** Инлайн-редактирование в ячейках таблицы. Изменения сохраняются локально (`editedValues`) и отправляются на сервер пакетом при нажатии "Сохранить".

### Умный интерфейс
*   **Sticky Columns:** Первый столбец с названиями проектов и заголовок таблицы закреплены для удобной навигации по большой таблице.
*   **Dynamic Resizing:** Ширина столбцов может быть изменена пользователем (drag-and-drop границ). Настройки сохраняются в `localStorage`.

## 2. AI-Функции (Single Mode)

В каждой ячейке (если поле доступно для проекта) есть кнопка с иконкой "Волшебная палочка". Она запускает специализированный генератор для этого конкретного поля:

*   **Для обычных полей:** Работает базовый генератор.
*   **Для спец. полей:**
    *   "Описание компании" -> запускает `api.generateCompanyDesc`.
    *   "Описание товаров и услуг" -> запускает `api.generateProductsDesc`.
    *   "Тональность бренда" -> запускает `api.generateTone`.

Результат генерации открывается в модальном окне `AiContextAutofillModal`, где пользователь может отредактировать его или применить.

## 3. Массовое AI-заполнение (`MassAiAutofillModal`)

Кнопка "✨ Массовое заполнение" открывает инструмент для пакетной обработки проектов.

### Режимы работы
1.  **Все пустые поля:** Пытается заполнить вообще всё, что не заполнено.
2.  **Базовая информация:** Заполняет только факты (адреса, телефоны, ссылки), используя данные из шапки группы VK.
3.  **Тональность / Товары / О компании:** Запускает специализированные генераторы для всех выбранных проектов.

### Логика работы
*   Процесс запускается на клиенте и последовательно обрабатывает проект за проектом.
*   Прогресс отображается в хедере ("Обработка (3/10): Название проекта").
*   Данные не сохраняются в БД автоматически — они попадают в `editedValues` (подсвечиваются в таблице), чтобы администратор мог их проверить перед финальным сохранением.

## 4. Очистка данных

Реализованы удобные инструменты для сброса данных:
*   **Очистить ячейку:** Вручную стереть текст.
*   **Очистить строку:** Кнопка корзины рядом с именем проекта очищает все поля для этого проекта.
*   **Очистить столбец:** Кнопка корзины в заголовке столбца очищает это поле у всех отображаемых проектов.
*   **Очистить всё:** Глобальная кнопка сброса.

Все операции очистки обратимы до нажатия кнопки "Сохранить" (достаточно обновить страницу).
