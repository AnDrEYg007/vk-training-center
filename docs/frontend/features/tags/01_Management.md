# Управление Тегами

**Компонент:** `features/tags/components/modals/TagsManagementModal.tsx`
**Встраиваемый редактор:** `features/projects/components/modals/TagsEditor.tsx`

## 1. Концепция тегов

Теги в системе используются для автоматической категоризации контента.
*   **Сущность:** Тег имеет `name` (для отображения), `keyword` (для поиска в тексте), `color` (для UI) и `note`.
*   **Автоматизация:** При сохранении или обновлении поста, бэкенд сканирует его текст. Если найдено `keyword` тега (поиск по целому слову, regex `\b...\b`), тег присваивается посту.

## 2. Интерфейс управления (`TagsManagementModal`)

Это модальное окно вызывается из шапки календаря (`ScheduleHeader`).

### Функционал
*   **CRUD:** Создание, редактирование и удаление тегов.
*   **Color Picker:** Выбор цвета из предустановленной палитры.
    *   *Реализация:* Использует `ColorPickerDropdown`, который рендерится через **React Portal** (`createPortal`), чтобы избежать проблем с `z-index` и `overflow` внутри модального окна.
*   **Dirty State:** Отслеживает изменения (`initialTags` vs `editedTags`). При попытке закрытия с несохраненными изменениями запрашивает подтверждение.

### Перетегирование (`handleRetagProject`)
В футере окна есть кнопка "Обновить теги для всех постов".
*   **Действие:** Отправляет запрос на `/api/tags/retagProject`.
*   **Бэкенд:** Заново сканирует текст всех постов проекта и обновляет связи с тегами в БД.
*   **UI:** Фронтенд получает уведомление о завершении и обновляет отображение в календаре.

## 3. Встраиваемый редактор (`TagsEditor`)

Этот компонент используется внутри `ProjectSettingsModal`.
*   Он реализует ту же логику редактирования, что и модальное окно, но не имеет собственного футера с кнопкой "Сохранить".
*   Вместо этого он принимает функции `onTagChange`, `onAddTag`, `onRemoveTag` от родительского хука `useProjectSettingsManager`, делегируя сохранение общей кнопке "Сохранить" в настройках проекта.