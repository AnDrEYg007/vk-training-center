# Журнал изменений (Changelog) - Часть 5

Этот файл содержит историю версий и описание основных изменений в приложении "VK Content Helper", начиная с версии 1.66.0.

## Версия 1.66.0 - 2024-08-05

-   **Новый функционал: Статистика и Аналитика постов**
    -   **Что внедрено:** В раздел "Системные списки" -> "Посты (История)" добавлена панель детальной статистики.
    -   **Возможности:**
        1.  **Сводные показатели:** Общее и среднее количество лайков, комментариев, репостов и просмотров по всей базе сохраненных постов.
        2.  **Топ публикаций:** Автоматическое определение и отображение ссылок на лучшие посты по каждому типу активности (самый просматриваемый, самый залайканный и т.д.).
        3.  **Интерактивный график:** Визуализация динамики публикаций и реакций с разбивкой по месяцам. Поддерживает переключение метрик (кол-во постов, лайки, просмотры и т.д.).
    -   **Что дает пользователям:** Позволяет мгновенно оценить эффективность контента, выявить тренды и найти самые успешные публикации без необходимости вручную считать цифры.

-   **Исправление: Критическая ошибка дублирования ID постов (`IntegrityError`)**
    -   **Что исправлено:** Устранена ошибка `UNIQUE constraint failed: posts.id`, которая приводила к падению сервера (Error 500) при попытке обновить список постов.
    -   **Причина:** API ВКонтакте иногда возвращает дубликаты записей в одном ответе (например, закрепленный пост может прийти дважды: как `pinned` и как обычный пост в хронологии). При попытке записать этот "сырой" список в БД происходил конфликт уникальности первичного ключа.
    -   **Как работает сейчас:**
        1.  **Дедупликация:** Бэкенд теперь предварительно обрабатывает ответ от VK, фильтруя посты по уникальному ID (`ownerId_postId`) перед любой работой с БД.
        2.  **Агрессивная очистка:** Внедрен механизм "агрессивной очистки" перед вставкой (`post_crud.py`). Если в БД существуют "зомби-записи" с такими же ID (например, от старых или конфликтующих проектов), они принудительно удаляются перед записью новых данных.
    -   **Что дает пользователям:** Стабильная работа синхронизации постов. Ошибки 500 при обновлении расписания или списков полностью устранены.